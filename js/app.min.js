"use strict";document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("form");function t(e){e.parentElement.classList.add("_error"),e.classList.add("_error")}function n(e){e.parentElement.classList.remove("_error"),e.classList.remove("_error")}function o(e){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(e.value)}e.addEventListener("submit",(async function(c){c.preventDefault();let r=function(e){let c=0,r=document.querySelectorAll("._req");for(let e=0;e<r.length;e++){const l=r[e];n(l),l.classList.contains("_email")?o(l)&&(t(l),c++):""===l.value&&(t(l),c++)}return c}(),l=new FormData(e);if(0===r){let t=await fetch("sendmail.php",{method:"POST",body:l});if(t.ok){let n=await t.json();alert(n.message),e.reset()}else alert("Ошибка")}else alert("Заполните обязательные поля")}))})),window.addEventListener("load",(function(){document.querySelector(".wrapper")&&setTimeout((function(){document.querySelector(".wrapper").classList.add("_loaded")}),0)}));let unlock=!0;const isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};if(isMobile.any()){document.body.classList.add("_touch");let e=document.querySelectorAll(".menu__arrow");if(e.length>0)for(let t=0;t<e.length;t++){const n=e[t];n.addEventListener("click",(function(){n.parentElement.classList.toggle("_active")}))}}else document.body.classList.add("_pc");const iconMenu=document.querySelector(".menu__icon"),menuBody=document.querySelector(".menu__body");iconMenu&&iconMenu.addEventListener("click",(function(e){document.body.classList.toggle("_lock"),iconMenu.classList.toggle("_active"),menuBody.classList.toggle("_active")}));const popupLinks=document.querySelectorAll(".popup-link"),popupActive=document.querySelector(".popup.open");if(popupLinks.length>0)for(let e=0;e<popupLinks.length;e++){const t=popupLinks[e];t.addEventListener("click",(function(e){const n=t.getAttribute("href").replace("#","");popupOpen(document.getElementById(n)),e.preventDefault()}))}const popupCloseIcon=document.querySelectorAll(".close-popup");if(popupCloseIcon.length>0)for(let e=0;e<popupCloseIcon.length;e++){const t=popupCloseIcon[e];t.addEventListener("click",(function(e){popupClose(t.closest(".popup")),e.preventDefault()}))}function popupOpen(e){e&&(e.classList.add("open"),e.addEventListener("click",(function(e){e.target.closest(".popup__content")||popupClose(e.target.closest(".popup"))})))}function popupClose(e){e.classList.remove("open")}function init(){var e=new ymaps.Map("map",{controls:[],center:[55.7041336,37.5127628],zoom:13}),t=new ymaps.Placemark([55.7041336,37.5127628],{balloonContentHeader:"Sunday School",balloonContentBody:"Ломоносовский проспект, 29к1",balloonContentFooter:"+ 7 (495) 645-27-40",hasBalloon:!0});e.geoObjects.add(t)}document.addEventListener("keydown",(function(e){if("Escape"==e.code){popupClose(document.querySelector(".popup.open"))}})),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector),ymaps.ready(init);let width,count=0;const container=document.querySelector(".gallery__container"),track=document.querySelector(".slider-track"),items=document.querySelectorAll(".slider-track img"),btnPrev=document.querySelector(".btn-prev"),btnNext=document.querySelector(".btn-next");function calcWidth(){width=container.offsetWidth,track.style.width=width*items.length+"px",items.forEach(e=>{e.style.width=width+"px",e.style.height="auto"}),rollSlider()}function rollSlider(){track.style.transform="translate(-"+count*width+"px)"}calcWidth(),window.addEventListener("resize",calcWidth),document.querySelector(".btn-next").addEventListener("click",(function(){count++,count>=items.length&&(count=0),rollSlider()})),document.querySelector(".btn-prev").addEventListener("click",(function(){count--,count<0&&(count=items.length-1),rollSlider()}));